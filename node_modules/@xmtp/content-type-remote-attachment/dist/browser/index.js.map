{"version":3,"file":"index.js","sources":["../../src/Attachment.ts","../../src/encryption/Ciphertext.ts","../../src/encryption/crypto.browser.ts","../../src/encryption/encryption.ts","../../src/RemoteAttachment.ts"],"sourcesContent":[null,null,null,null,null],"names":["ContentTypeAttachment","ContentTypeId","authorityId","typeId","versionMajor","versionMinor","AttachmentCodec","contentType","encode","content","type","parameters","filename","mimeType","data","decode","fallback","shouldPush","Ciphertext","aes256GcmHkdfSha256","constructor","obj","Error","payload","length","hkdfSalt","gcmNonce","this","toBytes","ciphertext","finish","fromBytes","bytes","crypto","window","hkdfNoInfo","Uint8Array","buffer","aesGcmParams","nonce","additionalData","name","iv","async","hkdf","secret","salt","key","subtle","importKey","deriveKey","hash","info","ContentTypeRemoteAttachment","RemoteAttachmentCodec","load","remoteAttachment","codecRegistry","response","fetch","url","arrayBuffer","digestBytes","digest","secp","utils","bytesToHex","contentDigest","encodedContentData","encrypted","decrypted","decrypt","encodedContent","proto","EncodedContent","codec","codecFor","encodeEncrypted","getRandomValues","plain","encrypt","startsWith","scheme","contentLength","String","TextEncoder","TextDecoder","hexToBytes","parseInt"],"mappings":"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"}